"use strict";(self.webpackChunkBlog=self.webpackChunkBlog||[]).push([[775],{775:(je,P,m)=>{m.r(P),m.d(P,{DEFAULT_IDENTITY_CREATE_FORM_PROPS:()=>V,DEFAULT_IDENTITY_EDIT_FORM_PROPS:()=>z,DEFAULT_IDENTITY_ENTITY_ACTIONS:()=>J,DEFAULT_IDENTITY_ENTITY_PROPS:()=>K,DEFAULT_IDENTITY_TOOLBAR_ACTIONS:()=>Q,IDENTITY_CREATE_FORM_PROP_CONTRIBUTORS:()=>R,IDENTITY_EDIT_FORM_PROP_CONTRIBUTORS:()=>M,IDENTITY_ENTITY_ACTION_CONTRIBUTORS:()=>x,IDENTITY_ENTITY_PROP_CONTRIBUTORS:()=>O,IDENTITY_TOOLBAR_ACTION_CONTRIBUTORS:()=>S,IdentityExtensionsGuard:()=>E,IdentityModule:()=>Ve,RolesComponent:()=>b,UsersComponent:()=>g});var l=m(6973),e=m(2223);let j=(()=>{var t;class a{constructor(s){this.restService=s,this.apiName="AbpIdentity",this.create=i=>this.restService.request({method:"POST",url:"/api/identity/roles",body:i},{apiName:this.apiName}),this.delete=i=>this.restService.request({method:"DELETE",url:`/api/identity/roles/${i}`},{apiName:this.apiName}),this.get=i=>this.restService.request({method:"GET",url:`/api/identity/roles/${i}`},{apiName:this.apiName}),this.getAllList=()=>this.restService.request({method:"GET",url:"/api/identity/roles/all"},{apiName:this.apiName}),this.getList=i=>this.restService.request({method:"GET",url:"/api/identity/roles",params:{filter:i.filter,sorting:i.sorting,skipCount:i.skipCount,maxResultCount:i.maxResultCount}},{apiName:this.apiName}),this.update=(i,o)=>this.restService.request({method:"PUT",url:`/api/identity/roles/${i}`,body:o},{apiName:this.apiName})}}return(t=a).\u0275fac=function(s){return new(s||t)(e.LFG(l.vgb))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),a})(),$=(()=>{var t;class a{constructor(s){this.restService=s,this.apiName="AbpIdentity",this.create=i=>this.restService.request({method:"POST",url:"/api/identity/users",body:i},{apiName:this.apiName}),this.delete=i=>this.restService.request({method:"DELETE",url:`/api/identity/users/${i}`},{apiName:this.apiName}),this.findByEmail=i=>this.restService.request({method:"GET",url:`/api/identity/users/by-email/${i}`},{apiName:this.apiName}),this.findByUsername=i=>this.restService.request({method:"GET",url:`/api/identity/users/by-username/${i}`},{apiName:this.apiName}),this.get=i=>this.restService.request({method:"GET",url:`/api/identity/users/${i}`},{apiName:this.apiName}),this.getAssignableRoles=()=>this.restService.request({method:"GET",url:"/api/identity/users/assignable-roles"},{apiName:this.apiName}),this.getList=i=>this.restService.request({method:"GET",url:"/api/identity/users",params:{filter:i.filter,sorting:i.sorting,skipCount:i.skipCount,maxResultCount:i.maxResultCount}},{apiName:this.apiName}),this.getRoles=i=>this.restService.request({method:"GET",url:`/api/identity/users/${i}/roles`},{apiName:this.apiName}),this.update=(i,o)=>this.restService.request({method:"PUT",url:`/api/identity/users/${i}`,body:o},{apiName:this.apiName}),this.updateRoles=(i,o)=>this.restService.request({method:"PUT",url:`/api/identity/users/${i}/roles`,body:o},{apiName:this.apiName})}}return(t=a).\u0275fac=function(s){return new(s||t)(e.LFG(l.vgb))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),a})();var d=m(6104),c=m(9338),T=m(8746),N=m(8505),D=m(3900),U=m(4004),p=m(5030),v=m(4115);let H=(()=>{var t;class a{constructor(s){this.restService=s,this.apiName="AbpPermissionManagement",this.get=(i,o)=>this.restService.request({method:"GET",url:"/api/permission-management/permissions",params:{providerName:i,providerKey:o}},{apiName:this.apiName}),this.update=(i,o,r)=>this.restService.request({method:"PUT",url:"/api/permission-management/permissions",params:{providerName:i,providerKey:o},body:r},{apiName:this.apiName})}}return(t=a).\u0275fac=function(s){return new(s||t)(e.LFG(l.vgb))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),a})();var W=m(7272),I=m(9646),X=m(5698),f=m(4755);const ee=["selectAllInThisTabsRef"],te=["selectAllInAllTabsRef"];function se(t,a){if(1&t&&(e.TgZ(0,"h4"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.AsE(" ",e.lcZ(2,2,"AbpPermissionManagement::Permissions")," - ",n.entityDisplayName||n.data.entityDisplayName," ")}}function ie(t,a){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const n=e.oxw().ngIf;e.xp6(1),e.hij("(",n.assignedCount,")")}}function ne(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"a",24),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,o=e.oxw(3);return e.KtG(o.onChangeGroup(i))})("select",function(){e.CHM(n);const i=e.oxw().$implicit,o=e.oxw(3);return e.KtG(o.setDisabled(i.permissions))}),e.TgZ(1,"div"),e._uU(2),e.YNc(3,ie,2,1,"span",1),e.qZA()()}if(2&t){const n=a.ngIf,s=e.oxw().$implicit,i=e.oxw(3);e.ekj("active",(null==i.selectedGroup?null:i.selectedGroup.name)===(null==s?null:s.name)),e.xp6(1),e.ekj("font-weight-bold",n.assignedCount),e.xp6(1),e.hij(" ",null==s?null:s.displayName," "),e.xp6(1),e.Q6J("ngIf",n.assignedCount>0)}}const ae=function(t){return{assignedCount:t}};function oe(t,a){if(1&t&&(e.TgZ(0,"li",22),e.YNc(1,ne,4,6,"a",23),e.qZA()),2&t){const n=a.$implicit,s=e.oxw(3);e.xp6(1),e.Q6J("ngIf",e.VKq(1,ae,s.getAssignedCount(n.name)))}}function re(t,a){if(1&t&&(e.TgZ(0,"span",30),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.AsE("",n.providerName,": ",n.providerKey,"")}}function le(t,a){if(1&t&&(e.ynx(0),e.YNc(1,re,2,2,"span",29),e.BQk()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",n.grantedProviders)}}function ce(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div",25)(1,"input",26,27),e.NdJ("click",function(){const o=e.CHM(n).$implicit,r=e.MAs(2),u=e.oxw(3);return e.KtG(u.onClickCheckbox(o,r.value))}),e.qZA(),e.TgZ(3,"label",28),e._uU(4),e.YNc(5,le,2,1,"ng-container",1),e.qZA()()}if(2&t){const n=a.$implicit,s=e.oxw(3);e.Q6J("ngStyle",n.style),e.xp6(1),e.Q6J("checked",s.getChecked(n.name))("value",s.getChecked(n.name))("disabled",s.isGrantedByOtherProviderName(n.grantedProviders)),e.uIk("id",n.name),e.xp6(2),e.uIk("for",n.name),e.xp6(1),e.hij("",n.displayName," "),e.xp6(1),e.Q6J("ngIf",!s.hideBadges)}}function pe(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div",5)(1,"div",6)(2,"div",7)(3,"input",8,9),e.NdJ("ngModelChange",function(i){e.CHM(n);const o=e.oxw(2);return e.KtG(o.selectAllTab=i)})("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.onClickSelectAll())}),e.qZA(),e.TgZ(5,"label",10),e._uU(6),e.ALo(7,"abpLocalization"),e.qZA()(),e._UZ(8,"hr",11),e.TgZ(9,"div",12)(10,"ul",13),e.YNc(11,oe,2,3,"li",14),e.qZA()()(),e.TgZ(12,"div",15)(13,"div",16)(14,"div",7)(15,"input",17,18),e.NdJ("ngModelChange",function(i){e.CHM(n);const o=e.oxw(2);return e.KtG(o.selectThisTab=i)})("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.onClickSelectThisTab())}),e.qZA(),e.TgZ(17,"label",19),e._uU(18),e.ALo(19,"abpLocalization"),e.qZA()(),e._UZ(20,"hr",20),e.YNc(21,ce,6,8,"div",21),e.qZA()()()}if(2&t){const n=e.oxw(2);e.xp6(3),e.Q6J("ngModel",n.selectAllTab)("disabled",n.disabledSelectAllInAllTabs),e.xp6(3),e.Oqu(e.lcZ(7,10,"AbpPermissionManagement::SelectAllInAllTabs")),e.xp6(5),e.Q6J("ngForOf",n.data.groups)("ngForTrackBy",n.trackByFn),e.xp6(4),e.Q6J("ngModel",n.selectThisTab)("disabled",n.disableSelectAllTab),e.xp6(3),e.Oqu(e.lcZ(19,12,"AbpPermissionManagement::SelectAllInThisTab")),e.xp6(3),e.Q6J("ngForOf",n.selectedGroupPermissions)("ngForTrackBy",n.trackByFn)}}function de(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"button",31),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"abp-button",32),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.submit())}),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()}2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,2,"AbpIdentity::Cancel")," "),e.xp6(3),e.Oqu(e.lcZ(5,4,"AbpIdentity::Save")))}function me(t,a){1&t&&(e.ynx(0),e.YNc(1,se,3,4,"ng-template",null,2,e.W1O),e.YNc(3,pe,22,14,"ng-template",null,3,e.W1O),e.YNc(5,de,6,6,"ng-template",null,4,e.W1O),e.BQk())}const ue=function(){return{size:"lg"}};let k=(()=>{var t;class a{get visible(){return this._visible}set visible(s){s!==this._visible&&(s?this.openModal().subscribe(()=>{this._visible=!0,this.visibleChange.emit(!0),(0,W.z)(this.selectAllInAllTabsRef.changes,this.selectAllInThisTabsRef.changes).pipe((0,X.q)(1)).subscribe(()=>{this.initModal()})}):(this.setSelectedGroup(null),this._visible=!1,this.visibleChange.emit(!1)))}constructor(s,i){this.service=s,this.configState=i,this.hideBadges=!1,this._visible=!1,this.visibleChange=new e.vpe,this.data={groups:[],entityDisplayName:""},this.permissions=[],this.selectThisTab=!1,this.selectAllTab=!1,this.disableSelectAllTab=!1,this.disabledSelectAllInAllTabs=!1,this.modalBusy=!1,this.selectedGroupPermissions=[],this.trackByFn=(o,r)=>r.name}getChecked(s){return(this.permissions.find(i=>i.name===s)||{isGranted:!1}).isGranted}setSelectedGroup(s){if(this.selectedGroup=s,!this.selectedGroup)return void(this.selectedGroupPermissions=[]);const i=`margin-${"rtl"===document.body.dir?"right":"left"}.px`,o=(this.data.groups.find(r=>r.name===this.selectedGroup?.name)||{}).permissions||[];this.selectedGroupPermissions=o.map(r=>({...r,style:{[i]:Z(o,r)},isGranted:(this.permissions.find(u=>u.name===r.name)||{}).isGranted}))}setDisabled(s){this.disableSelectAllTab=!!s.length&&s.every(i=>i.isGranted&&i.grantedProviders?.every(o=>o.providerName!==this.providerName))}isGrantedByOtherProviderName(s){return!!s.length&&s.findIndex(i=>i.providerName!==this.providerName)>-1}onClickCheckbox(s){s.isGranted&&this.isGrantedByOtherProviderName(s.grantedProviders)||setTimeout(()=>{this.permissions=this.permissions.map(i=>s.name===i.name?{...i,isGranted:!i.isGranted}:s.name===i.parentName&&s.isGranted?{...i,isGranted:!1}:s.parentName!==i.name||s.isGranted?i:{...i,isGranted:!0}),this.setTabCheckboxState(),this.setGrantCheckboxState()},0)}setTabCheckboxState(){const s=this.selectedGroupPermissions.filter(r=>r.grantedProviders.every(u=>u.providerName===this.providerName)),i=s.filter(r=>r.isGranted),o=document.querySelector("#select-all-in-this-tabs");i.length===s.length?(o.indeterminate=!1,this.selectThisTab=!0):0===i.length?(o.indeterminate=!1,this.selectThisTab=!1):o.indeterminate=!0}setGrantCheckboxState(){const s=this.permissions.filter(r=>r.grantedProviders.every(u=>u.providerName===this.providerName)),i=s.filter(r=>r.isGranted),o=document.querySelector("#select-all-in-all-tabs");i.length===s.length?(o.indeterminate=!1,this.selectAllTab=!0):0===i.length?(o.indeterminate=!1,this.selectAllTab=!1):o.indeterminate=!0}onClickSelectThisTab(){this.selectedGroupPermissions.forEach(s=>{if(s.isGranted&&this.isGrantedByOtherProviderName(s.grantedProviders))return;const i=this.permissions.findIndex(o=>o.name===s.name);this.permissions=[...this.permissions.slice(0,i),{...this.permissions[i],isGranted:!this.selectThisTab},...this.permissions.slice(i+1)]}),this.setGrantCheckboxState()}onClickSelectAll(){this.permissions=this.permissions.map(s=>({...s,isGranted:this.isGrantedByOtherProviderName(s.grantedProviders)||!this.selectAllTab})),this.disableSelectAllTab||(this.selectThisTab=!this.selectAllTab,this.setTabCheckboxState())}onChangeGroup(s){this.setDisabled(s.permissions),this.setSelectedGroup(s),this.setTabCheckboxState()}submit(){const s=F(this.data.groups),i=this.permissions.filter(o=>(s.find(r=>r.name===o.name)||{}).isGranted!==o.isGranted).map(({name:o,isGranted:r})=>({name:o,isGranted:r}));i.length?(this.modalBusy=!0,this.service.update(this.providerName,this.providerKey,{permissions:i}).pipe((0,D.w)(()=>this.shouldFetchAppConfig()?this.configState.refreshAppState():(0,I.of)(null)),(0,T.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.visible=!1})):this.visible=!1}openModal(){if(!this.providerKey||!this.providerName)throw new Error("Provider Key and Provider Name are required.");return this.service.get(this.providerName,this.providerKey).pipe((0,N.b)(s=>{this.data=s,this.permissions=F(s.groups),this.setSelectedGroup(s.groups[0]),this.disabledSelectAllInAllTabs=this.permissions.every(i=>i.isGranted&&i.grantedProviders.every(o=>o.providerName!==this.providerName))}))}initModal(){setTimeout(()=>{this.setDisabled(this.selectedGroup?.permissions||[]),this.setTabCheckboxState(),this.setGrantCheckboxState()})}getAssignedCount(s){return this.permissions.reduce((i,o)=>o.groupName===s&&o.isGranted?i+1:i,0)}shouldFetchAppConfig(){const s=this.configState.getOne("currentUser");return"R"===this.providerName?s.roles.some(i=>i===this.providerKey):"U"===this.providerName&&s.id===this.providerKey}}return(t=a).\u0275fac=function(s){return new(s||t)(e.Y36(H),e.Y36(l.XJE))},t.\u0275cmp=e.Xpm({type:t,selectors:[["abp-permission-management"]],viewQuery:function(s,i){if(1&s&&(e.Gf(ee,5),e.Gf(te,5)),2&s){let o;e.iGM(o=e.CRH())&&(i.selectAllInThisTabsRef=o),e.iGM(o=e.CRH())&&(i.selectAllInAllTabsRef=o)}},inputs:{providerName:"providerName",providerKey:"providerKey",hideBadges:"hideBadges",entityDisplayName:"entityDisplayName",visible:"visible"},outputs:{visibleChange:"visibleChange"},exportAs:["abpPermissionManagement"],decls:2,vars:5,consts:[[3,"visible","busy","options","visibleChange"],[4,"ngIf"],["abpHeader",""],["abpBody",""],["abpFooter",""],[1,"row"],[1,"col-md-4"],[1,"form-check","mb-2"],["type","checkbox","id","select-all-in-all-tabs","name","select-all-in-all-tabs",1,"form-check-input",3,"ngModel","disabled","ngModelChange","click"],["selectAllInAllTabsRef",""],["for","select-all-in-all-tabs",1,"form-check-label"],[1,"mt-2","mb-2"],[1,"overflow-auto"],[1,"nav","nav-pills","flex-column"],["class","nav-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-md-8","overflow-auto"],[1,"ps-1"],["type","checkbox","id","select-all-in-this-tabs","name","select-all-in-this-tabs",1,"form-check-input",3,"ngModel","disabled","ngModelChange","click"],["selectAllInThisTabsRef",""],["for","select-all-in-this-tabs",1,"form-check-label"],[1,"my-2"],["class","form-check mb-2",3,"ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],[1,"nav-item"],["class","nav-link pointer",3,"active","click","select",4,"ngIf"],[1,"nav-link","pointer",3,"click","select"],[1,"form-check","mb-2",3,"ngStyle"],["type","checkbox",1,"form-check-input",3,"checked","value","disabled","click"],["permissionCheckbox",""],[1,"form-check-label"],["class","badge bg-light text-dark",4,"ngFor","ngForOf"],[1,"badge","bg-light","text-dark"],["type","button","abpClose","",1,"btn","btn-secondary"],["iconClass","fa fa-check",3,"click"]],template:function(s,i){1&s&&(e.TgZ(0,"abp-modal",0),e.NdJ("visibleChange",function(r){return i.visible=r}),e.YNc(1,me,7,0,"ng-container",1),e.qZA()),2&s&&(e.Q6J("visible",i.visible)("busy",i.modalBusy)("options",e.DdM(4,ue)),e.xp6(1),e.Q6J("ngIf",i.data.entityDisplayName||i.entityDisplayName))},dependencies:[f.sg,f.O5,f.PC,p.Wl,p.JJ,p.On,d.r0,d.zS,d.YM,l.fuE],styles:[".overflow-scroll[_ngcontent-%COMP%]{max-height:70vh;overflow-y:scroll}"]}),a})();function Z(t,a){const n=t.find(s=>s.name===a.parentName);if(n&&n.parentName){let s=20;return s+=Z(t,n)}return n?20:0}function F(t){return t.reduce((a,n)=>[...a,...n.permissions.map(s=>({...s,groupName:n.name||""}))],[])}let _e=(()=>{var t;class a{}return(t=a).\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[l.IR2,d.e2]}),a})();var A=m(2857),h=m(5434),C=m(672);function he(t,a){if(1&t&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,null!=n.selected&&n.selected.id?"AbpIdentity::Edit":"AbpIdentity::NewRole"))}}function be(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"form",9),e.NdJ("ngSubmit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.save())}),e._UZ(1,"abp-extensible-form",10),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("formGroup",n.form),e.xp6(1),e.Q6J("selectedRecord",n.selected)}}function ge(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"button",11),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"abp-button",12),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.save())}),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()}if(2&t){const n=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,3,"AbpIdentity::Cancel")," "),e.xp6(2),e.Q6J("disabled",null==n.form?null:n.form.invalid),e.xp6(1),e.Oqu(e.lcZ(5,5,"AbpIdentity::Save"))}}function fe(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"abp-permission-management",13,14),e.NdJ("abpInit",function(){const o=e.CHM(n).initTemplate,r=e.MAs(1);return e.KtG(o(r))}),e.qZA()}}const ye=function(){return{value:"R"}},G=function(t){return{value:t}},L=function(t){return{value:t,twoWay:!0}},ve=function(){return{value:!0}},Te=function(t,a,n,s){return{providerName:t,providerKey:a,visible:n,hideBadges:s}},Y=function(t){return{visibleChange:t}},B=function(t,a,n){return{inputs:t,outputs:a,componentKey:n}},Ne=["modalContent"];function Ie(t,a){if(1&t&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,null!=n.selected&&n.selected.id?"AbpIdentity::Edit":"AbpIdentity::NewUser"))}}function Ae(t,a){1&t&&(e.TgZ(0,"div",14),e._UZ(1,"i",15),e.qZA())}function Ce(t,a){if(1&t&&e._UZ(0,"abp-extensible-form",23),2&t){const n=e.oxw(3);e.Q6J("selectedRecord",n.selected)}}function xe(t,a){if(1&t&&e._UZ(0,"abp-checkbox",27),2&t){const n=e.oxw(),s=n.index,i=n.$implicit,o=e.oxw(4);e.Q6J("checkboxId","roles-"+s)("formControl",i.controls[o.roles[s].name])("label",o.roles[s].name)}}const Se=function(t,a,n){return{checkboxId:t,label:a,formControl:n}},Oe=function(t,a){return{inputs:t,componentKey:a}};function Re(t,a){if(1&t&&(e.TgZ(0,"div",25),e.YNc(1,xe,1,3,"abp-checkbox",26),e.qZA()),2&t){const n=a.$implicit,s=a.index,i=e.oxw(4);e.xp6(1),e.Q6J("abpReplaceableTemplate",e.WLB(5,Oe,e.kEZ(1,Se,"roles-"+s,i.roles[s].name,n.controls[i.roles[s].name]),i.inputKey))}}function Me(t,a){if(1&t&&e.YNc(0,Re,2,8,"div",24),2&t){const n=e.oxw(3);e.Q6J("ngForOf",n.roleGroups)("ngForTrackBy",n.trackByFn)}}function Ee(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"form",16),e.NdJ("ngSubmit",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.save())}),e.TgZ(1,"ul",17,18)(3,"li",19)(4,"a",20),e._uU(5),e.ALo(6,"abpLocalization"),e.qZA(),e.YNc(7,Ce,1,1,"ng-template",21),e.qZA(),e.TgZ(8,"li",19)(9,"a",20),e._uU(10),e.ALo(11,"abpLocalization"),e.qZA(),e.YNc(12,Me,1,2,"ng-template",21),e.qZA()(),e._UZ(13,"div",22),e.qZA()}if(2&t){const n=e.MAs(2),s=e.oxw(2);e.Q6J("formGroup",s.form),e.xp6(5),e.Oqu(e.lcZ(6,4,"AbpIdentity::UserInformations")),e.xp6(5),e.Oqu(e.lcZ(11,6,"AbpIdentity::Roles")),e.xp6(3),e.Q6J("ngbNavOutlet",n)}}function Pe(t,a){if(1&t&&(e.YNc(0,Ae,2,0,"ng-template",null,12,e.W1O),e.YNc(2,Ee,14,8,"form",13)),2&t){const n=e.MAs(1),s=e.oxw();e.xp6(2),e.Q6J("ngIf",s.form)("ngIfElse",n)}}function De(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"button",28),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"abp-button",29),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.save())}),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()}if(2&t){const n=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,3,"AbpIdentity::Cancel")," "),e.xp6(2),e.Q6J("disabled",null==n.form?null:n.form.invalid),e.xp6(1),e.Oqu(e.lcZ(5,5,"AbpIdentity::Save"))}}function Ue(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"abp-permission-management",30,31),e.NdJ("abpInit",function(){const o=e.CHM(n).initTemplate,r=e.MAs(1);return e.KtG(o(r))}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("entityDisplayName",n.entityDisplayName)}}const ke=function(){return{value:"U"}},Ze=function(t,a,n){return{providerName:t,providerKey:a,visible:n}};let b=(()=>{var t;class a{constructor(s,i,o,r,u){this.list=s,this.confirmationService=i,this.toasterService=o,this.injector=r,this.service=u,this.data={items:[],totalCount:0},this.visiblePermissions=!1,this.modalBusy=!1,this.permissionManagementKey="PermissionManagement.PermissionManagementComponent",this.onVisiblePermissionChange=y=>{this.visiblePermissions=y}}ngOnInit(){this.hookToQuery()}buildForm(){const s=new c.lg(this.injector,this.selected);this.form=(0,c.se)(s)}openModal(){this.buildForm(),this.isModalVisible=!0}add(){this.selected={},this.openModal()}edit(s){this.service.get(s).subscribe(i=>{this.selected=i,this.openModal()})}save(){if(!this.form.valid)return;this.modalBusy=!0;const{id:s}=this.selected||{};(s?this.service.update(s,{...this.selected,...this.form.value}):this.service.create(this.form.value)).pipe((0,T.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1,this.list.get()})}delete(s,i){this.confirmationService.warn("AbpIdentity::RoleDeletionConfirmationMessage","AbpIdentity::AreYouSure",{messageLocalizationParams:[i]}).subscribe(o=>{o===d.Tv.Status.confirm&&(this.toasterService.success("AbpUi::SuccessfullyDeleted"),this.service.delete(s).subscribe(()=>this.list.get()))})}hookToQuery(){this.list.hookToQuery(s=>this.service.getList(s)).subscribe(s=>this.data=s)}openPermissionsModal(s){this.providerKey=s,setTimeout(()=>{this.visiblePermissions=!0},0)}sort(s){const{prop:i,dir:o}=s.sorts[0];this.list.sortKey=i,this.list.sortOrder=o}}return(t=a).\u0275fac=function(s){return new(s||t)(e.Y36(l.XNV),e.Y36(d.YP),e.Y36(d.MJ),e.Y36(e.zs3),e.Y36(j))},t.\u0275cmp=e.Xpm({type:t,selectors:[["abp-roles"]],features:[e._Bn([l.XNV,{provide:c.ex,useValue:"Identity.RolesComponent"}])],decls:13,vars:27,consts:[[3,"title","toolbar"],["id","identity-roles-wrapper",1,"card"],[1,"card-body"],[3,"data","recordsTotal","list"],[3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"abpInit",4,"abpReplaceableTemplate"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[3,"selectedRecord"],["type","button","abpClose","",1,"btn","btn-secondary"],["iconClass","fa fa-check",3,"disabled","click"],[3,"abpInit"],["abpPermissionManagement","abpPermissionManagement"]],template:function(s,i){1&s&&(e.TgZ(0,"abp-page",0),e.ALo(1,"abpLocalization"),e.TgZ(2,"div",1)(3,"div",2),e._UZ(4,"abp-extensible-table",3),e.qZA()(),e.TgZ(5,"abp-modal",4),e.NdJ("visibleChange",function(r){return i.isModalVisible=r}),e.YNc(6,he,3,3,"ng-template",null,5,e.W1O),e.YNc(8,be,2,2,"ng-template",null,6,e.W1O),e.YNc(10,ge,6,7,"ng-template",null,7,e.W1O),e.qZA(),e.YNc(12,fe,2,0,"abp-permission-management",8),e.qZA()),2&s&&(e.Q6J("title",e.lcZ(1,8,"AbpIdentity::Roles"))("toolbar",i.data.items),e.xp6(4),e.Q6J("data",i.data.items)("recordsTotal",i.data.totalCount)("list",i.list),e.xp6(1),e.Q6J("visible",i.isModalVisible)("busy",i.modalBusy),e.xp6(7),e.Q6J("abpReplaceableTemplate",e.kEZ(23,B,e.l5B(16,Te,e.DdM(10,ye),e.VKq(11,G,i.providerKey),e.VKq(13,L,i.visiblePermissions),e.DdM(15,ve)),e.VKq(21,Y,i.onVisiblePermissionChange),i.permissionManagementKey)))},dependencies:[p._Y,p.JL,p.sg,l.YzZ,l.Ngh,l.zLP,v.hL,d.r0,d.zS,d.YM,c.gt,c.m5,k,A.II,l.fuE],encapsulation:2}),a})(),g=(()=>{var t;class a{get roleGroups(){return this.form.get("roleNames")?.controls||[]}constructor(s,i,o,r,u,y){this.list=s,this.confirmationService=i,this.service=o,this.toasterService=r,this.fb=u,this.injector=y,this.data={items:[],totalCount:0},this.visiblePermissions=!1,this.modalBusy=!1,this.permissionManagementKey="PermissionManagement.PermissionManagementComponent",this.inputKey=d.hj.FormCheckboxComponent,this.trackByFn=(_,ze)=>Object.keys(ze)[0]||_,this.onVisiblePermissionChange=_=>{this.visiblePermissions=_}}ngOnInit(){this.hookToQuery()}buildForm(){const s=new c.lg(this.injector,this.selected);this.form=(0,c.se)(s),this.service.getAssignableRoles().subscribe(({items:i})=>{this.roles=i,this.roles&&this.form.addControl("roleNames",this.fb.array(this.roles.map(o=>this.fb.group({[o.name]:[this.selected?.id?!!this.selectedUserRoles?.find(r=>r.id===o.id):o.isDefault]}))))})}openModal(){this.buildForm(),this.isModalVisible=!0}add(){this.selected={},this.selectedUserRoles=[],this.openModal()}edit(s){this.service.get(s).pipe((0,N.b)(i=>this.selected=i),(0,D.w)(()=>this.service.getRoles(s))).subscribe(i=>{this.selectedUserRoles=i.items||[],this.openModal()})}save(){if(!this.form.valid||this.modalBusy)return;this.modalBusy=!0;const{roleNames:s=[]}=this.form.value,i=s.filter(r=>!!r[Object.keys(r)[0]]).map(r=>Object.keys(r)[0])||[],{id:o}=this.selected||{};(o?this.service.update(o,{...this.selected,...this.form.value,roleNames:i}):this.service.create({...this.form.value,roleNames:i})).pipe((0,T.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1,this.list.get()})}delete(s,i){this.confirmationService.warn("AbpIdentity::UserDeletionConfirmationMessage","AbpIdentity::AreYouSure",{messageLocalizationParams:[i]}).subscribe(o=>{o===d.Tv.Status.confirm&&this.service.delete(s).subscribe(()=>{this.toasterService.success("AbpUi::SuccessfullyDeleted"),this.list.get()})})}sort(s){const{prop:i,dir:o}=s.sorts[0];this.list.sortKey=i,this.list.sortOrder=o}hookToQuery(){this.list.hookToQuery(s=>this.service.getList(s)).subscribe(s=>this.data=s)}openPermissionsModal(s,i){this.providerKey=s,this.entityDisplayName=i,setTimeout(()=>{this.visiblePermissions=!0},0)}}return(t=a).\u0275fac=function(s){return new(s||t)(e.Y36(l.XNV),e.Y36(d.YP),e.Y36($),e.Y36(d.MJ),e.Y36(p.QS),e.Y36(e.zs3))},t.\u0275cmp=e.Xpm({type:t,selectors:[["abp-users"]],viewQuery:function(s,i){if(1&s&&e.Gf(Ne,5),2&s){let o;e.iGM(o=e.CRH())&&(i.modalContent=o.first)}},features:[e._Bn([l.XNV,{provide:c.ex,useValue:"Identity.UsersComponent"}])],decls:17,vars:29,consts:[[3,"title","toolbar"],["id","identity-roles-wrapper",1,"card"],[1,"card-body"],["id","data-tables-table-filter",1,"data-tables-filter","mb-3"],[1,"input-group"],["type","search",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[3,"data","recordsTotal","list"],[3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"entityDisplayName","abpInit",4,"abpReplaceableTemplate"],["loaderRef",""],[3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],[1,"text-center"],["aria-hidden","true",1,"fa","fa-pulse","fa-spinner"],[3,"formGroup","ngSubmit"],["ngbNav","",1,"nav-tabs"],["nav","ngbNav"],["ngbNavItem",""],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2","fade-in-top",3,"ngbNavOutlet"],[3,"selectedRecord"],["class","form-check mb-2",4,"ngFor","ngForOf","ngForTrackBy"],[1,"form-check","mb-2"],[3,"checkboxId","formControl","label",4,"abpReplaceableTemplate"],[3,"checkboxId","formControl","label"],["type","button","abpClose","",1,"btn","btn-secondary"],["iconClass","fa fa-check",3,"disabled","click"],[3,"entityDisplayName","abpInit"],["abpPermissionManagement","abpPermissionManagement"]],template:function(s,i){1&s&&(e.TgZ(0,"abp-page",0),e.ALo(1,"abpLocalization"),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"input",5),e.NdJ("ngModelChange",function(r){return i.list.filter=r}),e.ALo(7,"abpLocalization"),e.qZA()()(),e._UZ(8,"abp-extensible-table",6),e.qZA()(),e.TgZ(9,"abp-modal",7),e.NdJ("visibleChange",function(r){return i.isModalVisible=r}),e.YNc(10,Ie,3,3,"ng-template",null,8,e.W1O),e.YNc(12,Pe,3,2,"ng-template",null,9,e.W1O),e.YNc(14,De,6,7,"ng-template",null,10,e.W1O),e.qZA(),e.YNc(16,Ue,2,1,"abp-permission-management",11),e.qZA()),2&s&&(e.Q6J("title",e.lcZ(1,10,"AbpIdentity::Users"))("toolbar",i.data.items),e.xp6(6),e.Q6J("placeholder",e.lcZ(7,12,"AbpUi::PagerSearch"))("ngModel",i.list.filter),e.xp6(2),e.Q6J("data",i.data.items)("recordsTotal",i.data.totalCount)("list",i.list),e.xp6(1),e.Q6J("visible",i.isModalVisible)("busy",i.modalBusy),e.xp6(7),e.Q6J("abpReplaceableTemplate",e.kEZ(25,B,e.kEZ(19,Ze,e.DdM(14,ke),e.VKq(15,G,i.providerKey),e.VKq(17,L,i.visiblePermissions)),e.VKq(23,Y,i.onVisiblePermissionChange),i.permissionManagementKey)))},dependencies:[f.sg,f.O5,p._Y,p.Fj,p.JJ,p.JL,p.On,p.oH,p.sg,l.YzZ,l.Ngh,l.zLP,h.uN,h.Pz,h.nv,h.Is,h.Vx,h.tO,h.Dy,v.hL,v.J5,d.r0,d.zS,d.YM,d.a0,c.gt,c.m5,k,A.II,l.fuE],encapsulation:2}),a})();const Fe=c.uk.createMany([{text:"AbpIdentity::Edit",action:t=>{t.getInjected(b).edit(t.record.id||"")},permission:"AbpIdentity.Roles.Update"},{text:"AbpIdentity::Permissions",action:t=>{t.getInjected(b).openPermissionsModal(t.record.name||"")},permission:"AbpIdentity.Roles.ManagePermissions"},{text:"AbpIdentity::Delete",action:t=>{t.getInjected(b).delete(t.record.id||"",t.record.name||"")},permission:"AbpIdentity.Roles.Delete",visible:t=>!t?.record.isStatic}]),Ge=c.QC.createMany([{type:"string",name:"name",displayName:"AbpIdentity::RoleName",sortable:!0,valueResolver:t=>{const a=t.getInjected(l.oQ8),n=a.instant.bind(a),{isDefault:s,isPublic:i,name:o}=t.record;return(0,I.of)((0,l.F04)(o)+(s?`<span class="badge rounded-pill bg-success ms-1">${n("AbpIdentity::DisplayName:IsDefault")}</span>`:"")+(i?`<span class="badge rounded-pill bg-info ms-1">${n("AbpIdentity::DisplayName:IsPublic")}</span>`:""))}}]),q=c.Od.createMany([{type:"string",name:"name",displayName:"AbpIdentity::RoleName",id:"role-name",disabled:t=>t.record&&t.record.isStatic,validators:()=>[p.Validators.required]},{type:"boolean",name:"isDefault",displayName:"AbpIdentity::DisplayName:IsDefault",id:"role-is-default",defaultValue:!1},{type:"boolean",name:"isPublic",displayName:"AbpIdentity::DisplayName:IsPublic",id:"role-is-public",defaultValue:!1}]),Le=q,Ye=c.JE.createMany([{text:"AbpIdentity::NewRole",action:t=>{t.getInjected(b).add()},permission:"AbpIdentity.Roles.Create",icon:"fa fa-plus"}]),Be=c.uk.createMany([{text:"AbpIdentity::Edit",action:t=>{t.getInjected(g).edit(t.record.id||"")},permission:"AbpIdentity.Users.Update"},{text:"AbpIdentity::Permissions",action:t=>{t.getInjected(g).openPermissionsModal(t.record.id||"",t.record.userName)},permission:"AbpIdentity.Users.ManagePermissions"},{text:"AbpIdentity::Delete",action:t=>{t.getInjected(g).delete(t.record.id||"",t.record.name||t.record.userName||"")},visible:t=>{const a=t?.record.userName,s=t?.getInjected(l.XJE)?.getOne("currentUser");return a!==s.userName},permission:"AbpIdentity.Users.Delete"}]),qe=c.QC.createMany([{type:"string",name:"userName",displayName:"AbpIdentity::UserName",sortable:!0,columnWidth:250,valueResolver:t=>{const a=t.getInjected(l.oQ8),s=`<i title="${a.instant.bind(a)("AbpIdentity::ThisUserIsNotActiveMessage")}" class="fas fa-ban text-danger me-1" aria-hidden="true"></i>`;return(0,I.of)(`\n        ${t.record.isActive?"":s}\n        <span class="${t.record.isActive?"":"text-muted"}">${(0,l.F04)(t.record.userName)}</span>`)}},{type:"string",name:"email",displayName:"AbpIdentity::EmailAddress",sortable:!0,columnWidth:250},{type:"string",name:"phoneNumber",displayName:"AbpIdentity::PhoneNumber",sortable:!0,columnWidth:250}]),w=c.Od.createMany([{type:"string",name:"userName",displayName:"AbpIdentity::UserName",id:"user-name",validators:()=>[p.Validators.required,p.Validators.maxLength(256)]},{type:"passwordinputgroup",name:"password",displayName:"AbpIdentity::Password",id:"password",autocomplete:"new-password",validators:t=>[p.Validators.required,...(0,d.dD)({get:t.getInjected})]},{type:"string",name:"name",displayName:"AbpIdentity::DisplayName:Name",id:"name",validators:()=>[p.Validators.maxLength(64)]},{type:"string",name:"surname",displayName:"AbpIdentity::DisplayName:Surname",id:"surname",validators:()=>[p.Validators.maxLength(64)]},{type:"email",name:"email",displayName:"AbpIdentity::EmailAddress",id:"email",validators:()=>[p.Validators.required,p.Validators.maxLength(256),p.Validators.email]},{type:"string",name:"phoneNumber",displayName:"AbpIdentity::PhoneNumber",id:"phone-number",validators:()=>[p.Validators.maxLength(16)]},{type:"boolean",name:"isActive",displayName:"AbpIdentity::DisplayName:IsActive",id:"active-checkbox",defaultValue:!0},{type:"boolean",name:"lockoutEnabled",displayName:"AbpIdentity::DisplayName:LockoutEnabled",id:"lockout-checkbox",defaultValue:!0}]),we=w.map(t=>"password"===t.name?{...t,validators:a=>[...(0,d.dD)({get:a.getInjected})]}:t),Je=c.JE.createMany([{text:"AbpIdentity::NewUser",action:t=>{t.getInjected(g).add()},permission:"AbpIdentity.Users.Create",icon:"fa fa-plus"}]),J={"Identity.RolesComponent":Fe,"Identity.UsersComponent":Be},Q={"Identity.RolesComponent":Ye,"Identity.UsersComponent":Je},K={"Identity.RolesComponent":Ge,"Identity.UsersComponent":qe},V={"Identity.RolesComponent":q,"Identity.UsersComponent":w},z={"Identity.RolesComponent":Le,"Identity.UsersComponent":we},x=new e.OlP("IDENTITY_ENTITY_ACTION_CONTRIBUTORS"),S=new e.OlP("IDENTITY_TOOLBAR_ACTION_CONTRIBUTORS"),O=new e.OlP("IDENTITY_ENTITY_PROP_CONTRIBUTORS"),R=new e.OlP("IDENTITY_CREATE_FORM_PROP_CONTRIBUTORS"),M=new e.OlP("IDENTITY_EDIT_FORM_PROP_CONTRIBUTORS");let E=(()=>{var t;class a{constructor(){this.configState=(0,e.f3M)(l.XJE),this.extensions=(0,e.f3M)(c.X6)}canActivate(){const s={optional:!0},i=(0,e.f3M)(x,s)||{},o=(0,e.f3M)(S,s)||{},r=(0,e.f3M)(O,s)||{},u=(0,e.f3M)(R,s)||{},y=(0,e.f3M)(M,s)||{};return(0,c.ot)(this.configState,"Identity").pipe((0,U.U)(_=>({"Identity.RolesComponent":_.Role,"Identity.UsersComponent":_.User})),(0,c.V_)(this.configState,"AbpIdentity"),(0,N.b)(_=>{(0,c.Fr)(this.extensions.entityActions,J,i),(0,c.Fr)(this.extensions.toolbarActions,Q,o),(0,c.Hp)(this.extensions.entityProps,K,_.prop,r),(0,c.Hp)(this.extensions.createFormProps,V,_.createForm,u),(0,c.Hp)(this.extensions.editFormProps,z,_.editForm,y)}),(0,U.U)(()=>!0))}}return(t=a).\u0275fac=function(s){return new(s||t)},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),a})();const Qe=[{path:"",redirectTo:"roles",pathMatch:"full"},{path:"",component:l.O39,canActivate:(0,C.BJ)([l.a1M,l.nG9,E]),children:[{path:"roles",component:l.c$y,data:{requiredPolicy:"AbpIdentity.Roles",replaceableComponent:{key:"Identity.RolesComponent",defaultComponent:b}}},{path:"users",component:l.c$y,data:{requiredPolicy:"AbpIdentity.Users",replaceableComponent:{key:"Identity.UsersComponent",defaultComponent:g}}}]}];let Ke=(()=>{var t;class a{}return(t=a).\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[C.Bz.forChild(Qe),C.Bz]}),a})(),Ve=(()=>{var t;class a{static forChild(s={}){return{ngModule:a,providers:[{provide:x,useValue:s.entityActionContributors},{provide:S,useValue:s.toolbarActionContributors},{provide:O,useValue:s.entityPropContributors},{provide:R,useValue:s.createFormPropContributors},{provide:M,useValue:s.editFormPropContributors},E]}}static forLazy(s={}){return new l.Cgl(a.forChild(s))}}return(t=a).\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[l.IR2,Ke,h.Oz,d.e2,c.Ms,h.XC,_e,v.h2,A.BG]}),a})()}}]);